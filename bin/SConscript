#!python
import os
Import('env')
if not env.GetOption('clean'):
        env.Prepend(LIBS    = "oxsx") # needs to be first for ubuntu
        env.Append(LIBPATH = "#/build")
        includes  = " ".join(["-I" + Dir(x).abspath for x in env["CPPPATH"]])
        lib_paths = " ".join(["-L" + Dir(x).abspath for x in env["LIBPATH"]])
        libs      = " ".join(["-l" + x  for x in env["LIBS"]])
        if env["SYSTEM"] == "Darwin":
                link_flags      = " -Wl," + ",".join(env["LINKFLAGS"])
        else:
                link_flags = " -Wl," + ",".join("-rpath,{0}".format(x) for x in env["RPATH"])
        

        with open(os.path.join("compile.sh"), "w") as f:
                f.write(
                        ''' # This file is auto generated by scons
g++ $1 -o $(basename "$1" .cpp) -O2 {0} {1} {2} {3}
'''.format(includes, lib_paths, libs, link_flags)
                        )
